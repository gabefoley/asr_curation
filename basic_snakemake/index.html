
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../output/">
      
      
        <link rel="next" href="../detailed_explanation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.29">
    
    
      
        <title>Basic snakemake - ASR Curation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.76a95c52.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#snakefile" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="ASR Curation" class="md-header__button md-logo" aria-label="ASR Curation" data-md-component="logo">
      
  <img src="../images/tiny_logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            ASR Curation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Basic snakemake
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  ASR curation

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../install/" class="md-tabs__link">
          
  
  Installation and quickstart

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Detailed explanation

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../defining_files/" class="md-tabs__link">
          
  
  Customisation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="ASR Curation" class="md-nav__button md-logo" aria-label="ASR Curation" data-md-component="logo">
      
  <img src="../images/tiny_logo.png" alt="logo">

    </a>
    ASR Curation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ASR curation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation and quickstart
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation and quickstart
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../example/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running example data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Explanation of output
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Detailed explanation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Detailed explanation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Basic snakemake
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Basic snakemake
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#snakefile" class="md-nav__link">
    <span class="md-ellipsis">
      Snakefile
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-in-snakefiles" class="md-nav__link">
    <span class="md-ellipsis">
      Rules in snakefiles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#triggering-a-snakemake-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Triggering a snakemake pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snakemake-pipelines-only-rerun-what-is-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Snakemake pipelines only rerun what is needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-closer-look-at-snakemake-rules" class="md-nav__link">
    <span class="md-ellipsis">
      A closer look at snakemake rules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../detailed_explanation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snakemake diagram
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Customisation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Customisation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../defining_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Defining files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../customising_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Customising workflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#snakefile" class="md-nav__link">
    <span class="md-ellipsis">
      Snakefile
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rules-in-snakefiles" class="md-nav__link">
    <span class="md-ellipsis">
      Rules in snakefiles
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#triggering-a-snakemake-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      Triggering a snakemake pipeline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snakemake-pipelines-only-rerun-what-is-needed" class="md-nav__link">
    <span class="md-ellipsis">
      Snakemake pipelines only rerun what is needed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-closer-look-at-snakemake-rules" class="md-nav__link">
    <span class="md-ellipsis">
      A closer look at snakemake rules
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Basic snakemake</h1>

<h2 id="snakefile"><strong>Snakefile</strong></h2>
<p>The main workflow is contained within the <code>snakefile</code> file in the top folder of the <code>asr_curation</code> repository.</p>
<p>A <code>snakefile</code> contains a series of rules that define -</p>
<ul>
<li>an input</li>
<li>an output</li>
<li>how to get to the output from the input, typically either a Python script or a shell command</li>
</ul>
<h2 id="rules-in-snakefiles"><strong>Rules in snakefiles</strong></h2>
<p>For example, this rule defines -  </p>
<ul>
<li>the input as an alignment, </li>
<li>the output as a tree file (in Newick format) </li>
<li>a shell command to run in order to generate this - in this case calling <code>FastTree</code></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="n">infer_tree</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/</span><span class="si">{dataset}</span><span class="s2">_</span><span class="si">{subset}</span><span class="s2">.aln&quot;</span>

    <span class="n">output</span><span class="p">:</span>
        <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/</span><span class="si">{dataset}</span><span class="s2">_</span><span class="si">{subset}</span><span class="s2">.nwk&quot;</span>

    <span class="n">shell</span><span class="p">:</span>
        <span class="s2">&quot;FastTree </span><span class="si">{input}</span><span class="s2"> &gt; </span><span class="si">{output}</span><span class="s2">&quot;</span>
</code></pre></div>
<p>Anything defined within curly brackets <code>{}</code> is a wildcard. </p>
<p>The wildcards in the shell command let us use the whatever we define as <code>input</code> and <code>output</code> within the shell command.</p>
<p>The wildcards in the input and output rules let as define different <code>dataset</code> and <code>subset</code> wildcards which makes it possible to run the
entire snakemake pipeline on different sets of data.</p>
<h2 id="triggering-a-snakemake-pipeline"><strong>Triggering a snakemake pipeline</strong></h2>
<p>Once you trigger a snakemake pipeline, it will look for the first command defined in the <code>snakefile</code> file and try to create the output.</p>
<p>By convention, this is a rule called <code>all</code> which we place at the top of the <code>snakefile</code></p>
<p>In <code>asr_curation</code> the following rule is defined as the first rule -</p>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="nb">all</span><span class="p">:</span>
        <span class="nb">input</span><span class="p">:</span>
            <span class="n">annotations</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">WORKDIR</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">/subsets/</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s1">/csv/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s1">_annotations.txt&#39;</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">DATASETS</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]],</span>
            <span class="n">ancestors</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">WORKDIR</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">/subsets/</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s1">/csv/</span><span class="si">{</span><span class="n">dataset</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">subset</span><span class="si">}</span><span class="s1">_ancestors.csv&#39;</span> <span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">DATASETS</span> <span class="k">for</span> <span class="n">subset</span> <span class="ow">in</span> <span class="n">subsets</span><span class="p">[</span><span class="n">dataset</span><span class="p">]]</span>
</code></pre></div>
<p>Snakemake will look to see if these <code>input</code> files already exists for each <code>dataset</code> and <code>subset</code> in terms of both the <code>annotations.txt</code> and the <code>ancestors.csv</code></p>
<p>If these files do not exist, snakemake finds a rule defined in the <code>snakefile</code> that it would need to run in order to generate these files</p>
<p>Ignoring the other detail, focus here on the output line - this rule will generate the output of <code>ancestors.csv</code> which is one of the files we needed as input to the <code>all</code> rule.</p>
<p>If this file didn't already exist, then we know we must run this rule in order to generate it!</p>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="n">add_annotations_from_ancestors</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">csv</span> <span class="o">=</span> <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/csv/</span><span class="si">{dataset}</span><span class="s2">_</span><span class="si">{subset}</span><span class="s2">_alignment.csv&quot;</span><span class="p">,</span>
        <span class="n">aln</span> <span class="o">=</span> <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/grasp_results/GRASP_ancestors.fa&quot;</span><span class="p">,</span>
    <span class="n">output</span><span class="p">:</span>
        <span class="n">csv</span> <span class="o">=</span> <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/csv/</span><span class="si">{dataset}</span><span class="s2">_</span><span class="si">{subset}</span><span class="s2">_ancestors.csv&quot;</span>
    <span class="n">script</span><span class="p">:</span>
        <span class="n">CUSTOM_ANCESTOR_DIR</span> <span class="o">+</span> <span class="s2">&quot;/add_annotations_from_ancestors_for_use_in_example_workflow.py&quot;</span>
</code></pre></div>
<h2 id="snakemake-pipelines-only-rerun-what-is-needed"><strong>Snakemake pipelines only rerun what is needed</strong></h2>
<p>Snakemake backtracks in this way, checking to see which rules need to be run in order to generate the required input for the <code>all</code> rule.</p>
<p>If no data at all has been generated it will start with the very first step in the workflow, but if some steps have been completed then
it does not need to regenerate them. This is an important concept in workflow management and saves us a lot of time.</p>
<p>For example, in the <code>asr_curation</code> pipeline, all of the subset files use the <code>annotation_files</code> generated from going to the UniProt and BRENDA databases.
So only one call to the databases needs to be made, and then all downstream analysis simply uses the generated output from the annotation steps.</p>
<h2 id="a-closer-look-at-snakemake-rules"><strong>A closer look at snakemake rules</strong></h2>
<p>Here are two <code>snakemake</code> rules. We can compare the differences in order to get a better sense of how to read <code>snakemake</code> rules in the <code>snakefile</code></p>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="n">validate_ids</span><span class="p">:</span>
   <span class="nb">input</span><span class="p">:</span>
       <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/csv/original/</span><span class="si">{dataset}</span><span class="s2">_original.csv&quot;</span>
   <span class="n">output</span><span class="p">:</span>
       <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/csv/validated/</span><span class="si">{dataset}</span><span class="s2">_validated.csv&quot;</span>
   <span class="n">script</span><span class="p">:</span>
       <span class="s2">&quot;scripts2/validate_ids.py&quot;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">rule</span> <span class="n">infer_tree</span><span class="p">:</span>
    <span class="nb">input</span><span class="p">:</span>
        <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/</span><span class="si">{dataset}</span><span class="s2">_</span><span class="si">{subset}</span><span class="s2">.aln&quot;</span>

    <span class="n">output</span><span class="p">:</span>
        <span class="n">WORKDIR</span> <span class="o">+</span> <span class="s2">&quot;/</span><span class="si">{dataset}</span><span class="s2">/subsets/</span><span class="si">{subset}</span><span class="s2">/</span><span class="si">{dataset}</span><span class="s2">_</span><span class="si">{subset}</span><span class="s2">.nwk&quot;</span>

    <span class="n">shell</span><span class="p">:</span>
        <span class="s2">&quot;FastTree </span><span class="si">{input}</span><span class="s2"> &gt; </span><span class="si">{output}</span><span class="s2">&quot;</span>
</code></pre></div>
<ul>
<li><code>validate_ids</code> only uses the <code>dataset</code> wildcard as it is only run once per <code>dataset</code></li>
<li><code>infer_tree</code> uses both the <code>dataset</code> and the <code>subset</code> wildcard as it is run once per <code>subset</code></li>
<li>Both rules use the wildcards to name the output files - for example, in the example workflow, the phylogenetic tree generated for the dataset <code>kari_example_ec_1_1_1_86</code> and subset <code>eukaryotic_kari</code> is written to <code>/{dataset}/subsets/{subset}/{dataset}_{subset}.nwk</code> or <code>/kari_example_ec_1_1_1_86/subsets/eukaryotic_kari/kari_example_ec_1_1_1_86_eukaryotic_kari.nwk</code>. This means that files can easily be identified and will not overwrite each other. </li>
<li><code>validate_ids</code> defines a <code>script</code> command - which tells <code>snakemake</code> to run the Python script <code>scripts/validate_ids.py</code>. You can look in the scripts folder to see exactly what is being run for each step.</li>
<li><code>infer_tree</code> defines a <code>shell</code> commmand - which tells <code>snakemake</code> to run the defined command on the command line.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "navigation.top"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  </body>
</html>